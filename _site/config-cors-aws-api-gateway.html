<!DOCTYPE html>
<html>

<head>
	<!-- Meta -->
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<meta name="generator" content="Jekyll">

	<title>AWS API Gateway CORS 설정</title>
  <meta name="description" content="API Gateway + Swagger 사용 시 CORS 문제 해결">

	<!-- CSS & fonts -->
	<link rel="stylesheet" href="/css/main.css">

	<!-- RSS -->
	<link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" />

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/img/favicon.ico">


  <!-- Plase Dont Go -->
  <script type="text/javascript" src="/js/pleaseDontGo.js"></script>
  <script type="text/javascript">
    pleaseDontGo.init({
      newTitle: 'Come back!',
      newFavicon: '/img/pleaseDontGo.ico',
      timeout: 1000
    });
  </script>


  <!-- Google Analytics-->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-85815564-2', 'auto');
    ga('send', 'pageview');

  </script>
</head>


<body>
	<div id="wrap">
	  	
	  	<!-- Navigation -->
	  	<nav id="nav">
	<div id="nav-list">
		<a href="/">BLOG</a>

		<!-- Nav pages -->
	  
	    
	  
	    
	      <a href="/about" title="ABOUT">ABOUT</a>
	    
	  
	    
	  
	    
	  
	    
	  
	    
	  
	    
	  
	    
	  

    <!-- Nav links -->
	  
<a href="https://github.com/sungjunyoung">GITHUB</a>
<a href="https://www.facebook.com/wnsdud1861">FACEBOOK</a>
<a href="mailto:wnsdud1861@gmail.com">MAILTO</a>


	</div>

  <!-- Nav footer -->
	
	  <footer>
	
	<span>version 1.0.0</span>

</footer>
	

</nav>

    
    <!-- Icon menu -->
	  <a id="nav-menu">
	  	<div id="menu"></div>
	  </a>

      <!-- Header -->
      
        <header id="header" class="parent justify-spaceBetween">
  <div class="inner w100 relative">
    <span class="f-left">
      <a href="/">
        <h1>
          <span>JUNYOUNG</span>BLOG
        </h1>
      </a>
    </span>
    <span id="nav-links" class="absolute right bottom">
      <!-- Nav pages -->
	    
	      
	    
	      
	        <a href="/about" title="ABOUT">ABOUT</a>
	      
	    
	      
	    
	      
	    
	      
	    
	      
	    
	      
	    
	      
	    

      <!-- Nav links -->
	    
<a href="https://github.com/sungjunyoung">GITHUB</a>
<a href="https://www.facebook.com/wnsdud1861">FACEBOOK</a>
<a href="mailto:wnsdud1861@gmail.com">MAILTO</a>


    </span>
  </div>
</header>

      

    <!-- Main content -->
	  <div id="container">
		  
		<main>

			<article id="post-page">
	<h2>AWS API Gateway CORS 설정</h2>
	<time datetime="2017-03-07T00:00:00+09:00" class="by-line">07 Mar 2017</time>
	<div class="content">

		<p><img src="/img/swagger_editor_cors_introduce.png" alt="swagger_editor_cors_introduce" /></p>

<p>Swagger Editor 에서 Try this operation 을 클릭하면, 
이런 안내문구가 나옵니다. CORS 는 Cross-origin 
resource sharing 의 약자로, 다른 도메인의 서버에 URL 을
 호출할 경우 보안상의 문제가 발생하게 되는데, 이 접근을 허용할 수
  있게 해주는 메커니즘입니다.</p>

<blockquote>
  <p>Learn more 를 클릭하면 해당 이슈에 대한 자세한 설명을 볼 수 있습니다.</p>

  <p>참고) <a href="https://github.com/swagger-api/swagger-editor/blob/master/docs/cors.md">https://github.com/swagger-api/swagger-editor/blob/master/docs/cors.md</a></p>
</blockquote>

<p><img src="/img/cors-menu-of-api-gateway.png" alt="cors-menu-of-api-gateway" /></p>

<p>API-Gateway 에서 해당 버튼을 누르고,
‘Enable CORS and replace existing CORS headers’ 를 
하게 되면 모든 것이 해결 될 줄 알았으나.. 여전히 swagger ui 
에서 테스트를 시도하면 서버에서 응답이 없습니다.</p>

<p>요리 저리 검색한 결과,</p>

<p><img src="/img/enable_cors_menu.png" alt="enable_cors_menu" /></p>

<p>위의 화면에서 Access-Control-Allow-Headers 입력란의 default 
문자열 뒤에 X-Requested-With 를 추가해 주고,</p>

<div class="highlighter-rouge"><pre class="highlight"><code>'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token, X-Requested-With'
</code></pre>
</div>

<blockquote>
  <p>X-Requested-With 는 해당 요청이 Ajax 라는 것을 의미하며,
 서버에서는 미리 준비를 하게 됩니다.</p>

  <p>참고) <a href="https://remysharp.com/2011/04/21/getting-cors-working">https://remysharp.com/2011/04/21/getting-cors-working</a></p>
</blockquote>

<p>방금 CORS 를 허용한 리소스 내의 메서드를 클릭하여 Method Response 로 들어갑니다.</p>

<p><img src="/img/method_response.png" alt="method_response" /></p>

<p>그리고 Response Headers for ~ 에서 Access-Control-Allow-Headers 와 X-Requested-With 헤더를 추가해 줍니다.</p>

<p><img src="/img/deploy_api.png" alt="deploy_api" /></p>

<p>해당 API 를 Deploy 하여 스테이지로 올린 후, Swagger-ui 혹은 Swagger-editor 에서 테스트 해보면, 정상적으로 작동하는 것을 확인할 수 있습니다.</p>

<p><img src="/img/normal_response_of_api.png" alt="normal_response_of_api" /></p>


	</div>
	<div id="disqus_thread"></div>
	<script>
		/**
		 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
		 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
		/*
		var disqus_config = function () {
		this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
		this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
		};
		*/
		(function() { // DON'T EDIT BELOW THIS LINE
			var d = document,
				s = d.createElement('script');
			s.src = 'https://blog-csficscaal.disqus.com/embed.js';
			s.setAttribute('data-timestamp', +new Date());
			(d.head || d.body).appendChild(s);
		})();
	</script>
	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</article>


	  </main>
		
		  <!-- Pagination links -->
      

	  </div>
	    
	    <!-- Footer -->
	    <footer><span>@2017 based on monochrome</span></footer>


	    <!-- Script -->
      <script src="/js/main.js"></script>	


	</div>
</body>
</html>
